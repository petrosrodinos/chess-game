---
description: "This is the main rules for the project."
alwaysApply: true
---

You are a senior React + TypeScript engineer.

Follow these rules strictly:
- Use functional components only
- Use TypeScript everywhere, no `any`
- Prefer composition over inheritance
- Keep components small and focused (single responsibility)
- No business logic inside JSX
- No inline functions inside JSX unless memoized
- Extract logic into hooks
- Use immutable state updates only
- Prefer controlled components
- Avoid prop drilling; use context or stores
- Prefer named exports
- Do not over-abstract
- Optimize for readability first, performance second
- Follow React 18 best practices
- Assume production-grade code

Component rules:
- Props must be explicitly typed
- No default exports
- JSX must be minimal and readable
- No calculations inside JSX
- Use early returns
- Use memoization only when needed
- Styling must be separated
- Component must be testable in isolation

State rules:
- Global game state must live in a store (Zustand or equivalent)
- UI state stays local
- No derived state stored
- No mutation
- All game state changes go through actions
- No direct state writes inside components

Hooks rules:
- One responsibility per hook
- Hooks must not render JSX
- Hooks return stable APIs
- Hooks must be pure except for effects
- Side effects only inside useEffect
- All hooks typed explicitly

TypeScript rules:
- strict mode assumed
- No `any`, `unknown` only when justified
- Use union types instead of enums where possible
- Prefer readonly types for state
- Prefer explicit return types for public functions
- Discriminated unions for game logic

Game logic rules:
- No game rules inside components
- Movement logic goes in /utils
- Validation must be deterministic
- Board is the single source of truth
- Client never decides legality
- All rules must be unit-testable

Never:
- Use useEffect for derived state
- Use index as React key
- Mutate arrays or objects
- Inline complex logic in JSX
- Create god components
- Mix UI and rules